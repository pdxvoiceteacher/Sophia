{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "ucc.public_signals.vote_proof_envelope.v1",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "manifest_id",
    "ballot_id",
    "nullifier_sha256",
    "ciphertext_sha256",
    "aad_sha256",
    "choice_hash",
    "public_inputs"
  ],
  "properties": {
    "manifest_id": { "type": "string", "minLength": 1 },
    "ballot_id": { "type": "string", "minLength": 1 },

    "nullifier_sha256": { "type": "string", "pattern": "^[0-9a-f]{64}$" },
    "ciphertext_sha256": { "type": "string", "pattern": "^[0-9a-f]{64}$" },
    "aad_sha256": { "type": "string", "pattern": "^[0-9a-f]{64}$" },
    "choice_hash": { "type": "string", "pattern": "^[0-9a-f]{64}$" },

    "public_inputs": {
      "type": "object",
      "additionalProperties": false,
      "required": ["format", "version", "order", "values"],
      "properties": {
        "format": { "const": "snarkjs.public_inputs.v1" },
        "version": { "const": 1 },
        "order": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 }
        },
        "values": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string" }
        }
      }
    }
  }
}
